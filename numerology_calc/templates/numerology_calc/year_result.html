{% extends 'numerology_calc/base.html' %}
{% load static %}

{% block title %}üîÆ –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ {{ target_year }} –≥–æ–¥ | –ö–æ–¥ –°—É–¥—å–±—ã{% endblock %}

{% block body_class %}result-page{% endblock %}

{% block extra_css %}
<style>
    /* –°—Ç–∏–ª–∏ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ */
    .calculation-steps {
        background: rgba(15, 21, 37, 0.5);
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        border-left: 4px solid var(--neon-blue);
    }
    
    .step {
        display: flex;
        align-items: flex-start;
        margin-bottom: 20px;
        padding-bottom: 20px;
        border-bottom: 1px solid rgba(255, 215, 0, 0.1);
    }
    
    .step:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
    }
    
    .step-number {
        background: var(--primary-gold);
        color: var(--dark-purple);
        width: 35px;
        height: 35px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.2rem;
        margin-right: 15px;
        flex-shrink: 0;
        box-shadow: 0 0 10px var(--primary-gold);
    }
    
    .step-content {
        flex: 1;
    }
    
    .step-content p {
        margin-bottom: 10px;
        color: var(--text-light);
    }
    
    .math-expression {
        background: rgba(10, 10, 26, 0.8);
        padding: 15px;
        border-radius: 10px;
        border: 1px solid rgba(157, 0, 255, 0.3);
        font-family: 'Courier New', monospace;
        font-size: 1.2rem;
        color: var(--primary-gold);
        margin: 10px 0;
    }
    
    .final-result {
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(157, 0, 255, 0.1));
        border-color: var(--primary-gold);
        font-size: 1.3rem;
        font-weight: bold;
    }
    
    .final-number-box {
        text-align: center;
        margin-top: 30px;
        padding: 30px;
        background: rgba(157, 0, 255, 0.1);
        border-radius: 15px;
        border: 2px solid var(--neon-purple);
    }
    
    .final-number {
        display: inline-block;
        text-align: center;
    }
    
    .final-number span {
        font-size: 4rem;
        font-weight: bold;
        color: var(--primary-gold);
        display: block;
        text-shadow: 0 0 20px var(--primary-gold);
    }
    
    .final-number small {
        color: var(--text-gray);
        font-size: 1rem;
        margin-top: 10px;
        display: block;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞ */
    .prognosis-text {
        line-height: 1.8;
        font-size: 1.1rem;
    }
    
    .prognosis-text h4 {
        color: var(--primary-gold);
        margin: 25px 0 15px 0;
        font-size: 1.4rem;
        border-bottom: 2px solid rgba(255, 215, 0, 0.2);
        padding-bottom: 10px;
    }
    
    .prognosis-text ul {
        padding-left: 25px;
        margin-bottom: 20px;
    }
    
    .prognosis-text li {
        margin-bottom: 10px;
        color: var(--text-light);
        position: relative;
        padding-left: 25px;
    }
    
    .prognosis-text li::before {
        content: '‚ú¶';
        position: absolute;
        left: 0;
        color: var(--primary-gold);
    }
    
    .advice-block {
        background: rgba(157, 0, 255, 0.05);
        border-radius: 15px;
        padding: 30px;
        border: 1px solid rgba(157, 0, 255, 0.2);
    }
    
    .advice-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin-top: 20px;
    }
    
    .advice-column {
        background: rgba(15, 21, 37, 0.5);
        padding: 25px;
        border-radius: 12px;
        border: 1px solid rgba(255, 215, 0, 0.1);
    }
    
    .advice-column h4 {
        color: var(--neon-blue);
        margin-bottom: 15px;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .advice-column ul {
        padding-left: 20px;
    }
    
    .advice-column li {
        margin-bottom: 10px;
        color: var(--text-light);
    }
    
    .section-navigation {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 40px;
        padding-top: 30px;
        border-top: 1px solid rgba(255, 215, 0, 0.1);
    }
    
    /* –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Å–µ–∫—Ü–∏—è–º */
    .section-nav-button {
        background: transparent;
        color: var(--primary-gold);
        border: 2px solid var(--primary-gold);
        border-radius: 10px;
        padding: 12px 25px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .section-nav-button:hover {
        background: rgba(255, 215, 0, 0.1);
        transform: translateY(-3px);
    }
    
    .section-nav-button.active {
        background: var(--primary-gold);
        color: var(--dark-purple);
    }
</style>
{% endblock %}

{% block content %}
<div class="result-container">
    <!-- –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ -->
    <a href="{% url 'home' %}" class="back-button">
        <i class="fas fa-arrow-left"></i> –ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç
    </a>
    
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ -->
    <div class="result-header">
        <h2><i class="fas fa-calendar-alt"></i> –í–∞—à –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ {{ target_year }} –≥–æ–¥</h2>
        <p class="result-subtitle">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: {{ birth_date|date:"d.m.Y" }}</p>
        <p class="result-subtitle">–í–∞—à–µ —á–∏—Å–ª–æ –≥–æ–¥–∞: <strong class="numeric-glow">{{ personal_year }}</strong></p>
    </div>
    
   
    <div class="section-navigation">
        <button class="section-nav-button active" data-section="quick-result">
            <i class="fas fa-bolt"></i> –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ–≥–Ω–æ–∑
        </button>
        <button class="section-nav-button" data-section="full-prognosis">
            <i class="fas fa-scroll"></i> –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑
        </button>
    </div>
    
  
    <div id="quick-result" class="result-full">
        <div class="detailed-content">
      
            <div class="detail-block">
                <div class="result-numbers" style="justify-content: center; margin-bottom: 30px;">
                    <div class="number-circle">
                        <span>{{ personal_year }}</span>
                        <small>–ß–∏—Å–ª–æ –≥–æ–¥–∞</small>
                    </div>
                </div>
                
                <h3><i class="fas fa-globe-americas"></i> {{ year_description.title }}</h3>
                <p class="subtitle">{{ year_description.subtitle }}</p>
                
                <div class="prognosis-text">
                    {{ year_description.short|safe }}
                </div>
                
                <div class="quick-tips">
                    <h4><i class="fas fa-lightbulb"></i> –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –≥–æ–¥–∞:</h4>
                    <ul>
                        <li><strong>–ì–ª–∞–≤–Ω–∞—è —Ç–µ–º–∞:</strong> {{ year_description.short }}</li>
                        <li><strong>–ß—Ç–æ –≤–∞–∂–Ω–æ:</strong> {{ year_description.subtitle }}</li>
                        <li><strong>–õ—É—á—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è:</strong> –ù–æ–≤—ã—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏–π –∏ –≤–∞–∂–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π</li>
                    </ul>
                </div>
            </div>
            
          
            <div style="text-align: center; margin-top: 40px;">
                <button class="mystic-button" data-section="full-prognosis">
                    <i class="fas fa-book-open"></i> –ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω—ã–π –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑
                </button>
            </div>
        </div>
    </div>
    
   
    <div id="full-prognosis" class="result-full" style="display: none;">
        <div class="detailed-content">
           
            <div class="detail-block">
                <h3><i class="fas fa-globe-americas"></i> {{ year_description.title }}</h3>
                <p class="subtitle">{{ year_description.subtitle }}</p>
                <div class="prognosis-text">
                    {{ year_description.full|safe }}
                </div>
            </div>
            
        
            <div class="detail-block">
                <h3><i class="fas fa-bolt"></i> {{ energy_description.title }}</h3>
                <div class="prognosis-text">
                    {{ energy_description.full|safe }}
                </div>
            </div>
            
          
    
        </div>
    </div>
    
   
  

    <div class="action-buttons">
        <a href="{% url 'home' %}#month-section" class="mystic-button">
            <i class="fas fa-moon"></i> –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–µ—Å—è—Ü
        </a>
        <a href="{% url 'home' %}#day-section" class="mystic-button">
            <i class="fas fa-star"></i> –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–µ–Ω—å
        </a>
        <a href="{% url 'home' %}" class="mystic-button" style="background: linear-gradient(135deg, var(--neon-purple), var(--neon-blue));">
            <i class="fas fa-redo"></i> –ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç –≥–æ–¥–∞
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
   
    const sectionButtons = document.querySelectorAll('.section-nav-button');
    const sections = {
        'quick-result': document.getElementById('quick-result'),
        'full-prognosis': document.getElementById('full-prognosis'),
        'detailed-calculation': document.getElementById('detailed-calculation')
    };
    
    
    function showSection(sectionId) {
      
        Object.values(sections).forEach(section => {
            if (section) {
                section.style.display = 'none';
                section.classList.remove('active-section');
            }
        });
        
      
        sectionButtons.forEach(btn => {
            btn.classList.remove('active');
        });
        
        
        const targetSection = sections[sectionId];
        if (targetSection) {
            targetSection.style.display = 'block';
            targetSection.classList.add('active-section');
            
         
            targetSection.style.opacity = '0';
            targetSection.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                targetSection.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                targetSection.style.opacity = '1';
                targetSection.style.transform = 'translateY(0)';
            }, 10);
        }
        
       
        const activeButton = document.querySelector(`[data-section="${sectionId}"]`);
        if (activeButton) {
            activeButton.classList.add('active');
        }
        
        
        if (targetSection) {
            setTimeout(() => {
                targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }
    }
    

    sectionButtons.forEach(button => {
        button.addEventListener('click', function() {
            const sectionId = this.getAttribute('data-section');
            showSection(sectionId);
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    document.querySelectorAll('[data-section]').forEach(button => {
        if (button.classList.contains('mystic-button') || button.classList.contains('details-button')) {
            button.addEventListener('click', function() {
                const sectionId = this.getAttribute('data-section');
                showSection(sectionId);
            });
        }
    });
    
    
    const yearNumber = document.querySelector('.number-circle span');
    if (yearNumber) {
        animateNumber(yearNumber);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ —á–∏—Å–ª–∞
    function animateNumber(element) {
        const finalNumber = parseInt(element.textContent);
        element.textContent = '0';
        
        let current = 0;
        const increment = finalNumber / 20;
        const timer = setInterval(() => {
            current += increment;
            if (current >= finalNumber) {
                element.textContent = finalNumber;
                clearInterval(timer);
                
              
                element.parentElement.style.animation = 'none';
                setTimeout(() => {
                    element.parentElement.style.animation = 'number-pulse 2s ease-in-out infinite';
                }, 10);
            } else {
                element.textContent = Math.floor(current);
            }
        }, 50);
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –ø–ª–∞–≤–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
    document.querySelectorAll('.action-buttons a').forEach(link => {
        link.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            if (href.includes('#')) {
                e.preventDefault();
                const targetId = href.split('#')[1];
                const targetElement = document.getElementById(targetId);
                
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                } else {
                    window.location.href = href;
                }
            }
        });
    });
});
</script>
{% endblock %}