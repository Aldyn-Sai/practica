{% extends 'numerology_calc/base.html' %}
{% load static %}

{% block title %}{% if user.is_authenticated %}üîÆ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.username }}!{% else %}üîÆ –ö–æ–¥ –°—É–¥—å–±—ã | –ù—É–º–µ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ü–æ—Ä—Ç–∞–ª{% endif %}{% endblock %}

{% block content %}
<!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
{% if user.is_authenticated %}
<div class="welcome-section">
    <div class="welcome-card">
        <div class="welcome-content">
            <h2><i class="fas fa-hand-sparkles"></i> –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.username }}!</h2>
            <p class="welcome-subtitle">–ì–æ—Ç–æ–≤—ã —Ä–∞—Å–∫—Ä—ã—Ç—å —Ç–∞–π–Ω—ã —á–∏—Å–µ–ª? –£ –≤–∞—Å —É–∂–µ <strong>{{ user_calculations }}</strong> —Ä–∞—Å—á–µ—Ç–æ–≤!</p>
            
            <div class="quick-stats">
                <div class="stat-item">
                    <i class="fas fa-calculator"></i>
                    <span>{{ user_calculations }}</span>
                    <small>–†–∞—Å—á–µ—Ç–æ–≤</small>
                </div>
                <div class="stat-item">
                    <i class="fas fa-crown"></i>
                    <span>–ù–æ–≤–∏—á–æ–∫</span>
                    <small>–£—Ä–æ–≤–µ–Ω—å</small>
                </div>
                <div class="stat-item">
                    <i class="fas fa-gem"></i>
                    <span>0</span>
                    <small>–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</small>
                </div>
            </div>
            
            <div class="welcome-actions">
                <a href="#year-section" class="welcome-button primary">
                    <i class="fas fa-bolt"></i> –ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç
                </a>
                <a href="{% url 'profile' %}" class="welcome-button secondary">
                    <i class="fas fa-user-circle"></i> –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å
                </a>
            </div>
        </div>
        
        <div class="welcome-tip">
            <i class="fas fa-lightbulb"></i>
            <div>
                <strong>–°–æ–≤–µ—Ç –¥–Ω—è:</strong> –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ–¥, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —ç–Ω–µ—Ä–≥–∏—é –Ω–∞ {{ year_form.initial.target_year|default:"2025" }} –≥–æ–¥.
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- –°–µ–∫—Ü–∏—è 1: –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –ì–æ–¥ -->
<section id="year-section" class="calculator-section">
    <div class="section-header">
        <h2><i class="fas fa-calendar-alt"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –ì–æ–¥</h2>
        <p class="section-subtitle">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ß–∏—Å–ª–æ –ì–æ–¥–∞ + –≠–Ω–µ—Ä–≥–∏—è –ì–æ–¥–∞</p>
    </div>
    
    <div class="calculator-card">
        {% if not user.is_authenticated %}
        <!-- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö -->
        <div class="locked-overlay">
            <div class="locked-icon">
                <i class="fas fa-lock"></i>
            </div>
            <div class="locked-message">
                <h3>–î–æ—Å—Ç—É–ø –∫ —Ä–∞—Å—á–µ—Ç–∞–º –∑–∞–∫—Ä—ã—Ç</h3>
                <p>–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</p>
                <div class="locked-actions">
                    <a href="{% url 'login' %}?next={{ request.path }}" class="mystic-button">
                        <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏
                    </a>
                    <a href="{% url 'register' %}" class="mystic-button" style="background: linear-gradient(135deg, var(--neon-purple), var(--neon-blue));">
                        <i class="fas fa-user-plus"></i> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </a>
                </div>
            </div>
        </div>
        {% endif %}
        
        <form method="post" action="{% url 'calculate_year' %}">
            {% csrf_token %}
            
            <div class="input-group">
                {{ year_form.birth_date.label_tag }}
                {{ year_form.birth_date }}
                {% if year_form.birth_date.errors %}
                <div class="error-message">
                    {{ year_form.birth_date.errors }}
                </div>
                {% endif %}
            </div>
            
            <div class="input-group">
                {{ year_form.target_year.label_tag }}
                {{ year_form.target_year }}
                {% if year_form.target_year.errors %}
                <div class="error-message">
                    {{ year_form.target_year.errors }}
                </div>
                {% endif %}
            </div>
            
            <button type="submit" class="mystic-button" {% if not user.is_authenticated %}disabled{% endif %}>
                <i class="fas fa-calculator"></i> 
                {% if user.is_authenticated %}
                –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –≥–æ–¥
                {% else %}
                –í–æ–π–¥–∏—Ç–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
                {% endif %}
            </button>
            
            {% if not user.is_authenticated %}
            <div class="auth-promo">
                <p><i class="fas fa-info-circle"></i> –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Å–µ —Ä–∞—Å—á–µ—Ç—ã –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ—é –Ω—É–º–µ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é –∏—Å—Ç–æ—Ä–∏—é</p>
            </div>
            {% endif %}
        </form>
    </div>
</section>


<section id="year-section" class="calculator-section">
    <div class="section-header">
        <h2><i class="fas fa-calendar-alt"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –ì–æ–¥</h2>
        <p class="section-subtitle">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ß–∏—Å–ª–æ –ì–æ–¥–∞ + –≠–Ω–µ—Ä–≥–∏—è –ì–æ–¥–∞</p>
    </div>
    
    <div class="calculator-card">
        <form method="post" action="{% url 'calculate_year' %}">
            {% csrf_token %}
            
            <div class="input-group">
                {{ year_form.birth_date.label_tag }}
                {{ year_form.birth_date }}
                {% if year_form.birth_date.errors %}
                <div class="error-message">
                    {{ year_form.birth_date.errors }}
                </div>
                {% endif %}
            </div>
            
            <div class="input-group">
                {{ year_form.target_year.label_tag }}
                {{ year_form.target_year }}
                {% if year_form.target_year.errors %}
                <div class="error-message">
                    {{ year_form.target_year.errors }}
                </div>
                {% endif %}
            </div>
            
            <button type="submit" class="mystic-button">
                <i class="fas fa-calculator"></i> –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –≥–æ–¥
            </button>
        </form>
    </div>
</section>


<section id="month-section" class="calculator-section">
    <div class="section-header">
        <h2><i class="fas fa-calendar-week"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –ú–µ—Å—è—Ü</h2>
        <p class="section-subtitle">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ß–∏—Å–ª–æ –ú–µ—Å—è—Ü–∞</p>
    </div>
    
    <div class="calculator-card">
        <div class="note-box">
            <i class="fas fa-info-circle"></i> 
            –î–ª—è —Ä–∞—Å—á–µ—Ç–∞ –Ω—É–∂–µ–Ω –≤–∞—à –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ì–æ–¥. –ï—Å–ª–∏ –≤—ã –µ–≥–æ —É–∂–µ —Ä–∞—Å—Å—á–∏—Ç–∞–ª–∏ –≤—ã—à–µ, –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –≤ –ø–æ–ª–µ –Ω–∏–∂–µ.
        </div>
        
        <form method="post" action="{% url 'calculate_month' %}">
            {% csrf_token %}
            
            <div class="input-group">
                {{ month_form.personal_year.label_tag }}
                {{ month_form.personal_year }}
                <small class="form-text">{{ month_form.personal_year.help_text }}</small>
                {% if month_form.personal_year.errors %}
                <div class="error-message">
                    {{ month_form.personal_year.errors }}
                </div>
                {% endif %}
            </div>
            
            <div class="input-group">
                {{ month_form.month.label_tag }}
                {{ month_form.month }}
                {% if month_form.month.errors %}
                <div class="error-message">
                    {{ month_form.month.errors }}
                </div>
                {% endif %}
            </div>
            
            <button type="submit" class="mystic-button">
                <i class="fas fa-moon"></i> –£–∑–Ω–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–µ—Å—è—Ü
            </button>
        </form>
    </div>
</section>


<section id="day-section" class="calculator-section">
    <div class="section-header">
        <h2><i class="fas fa-calendar-day"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –î–µ–Ω—å</h2>
        <p class="section-subtitle">–õ–∏—á–Ω–æ–µ –ß–∏—Å–ª–æ –î–Ω—è</p>
    </div>
    
    <div class="calculator-card">
        <form method="post" action="{% url 'calculate_day' %}">
            {% csrf_token %}
            
            <div class="input-group">
                {{ day_form.target_date.label_tag }}
                {{ day_form.target_date }}
                {% if day_form.target_date.errors %}
                <div class="error-message">
                    {{ day_form.target_date.errors }}
                </div>
                {% endif %}
            </div>
            
            <button type="submit" class="mystic-button">
                <i class="fas fa-star"></i> –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –∑–Ω–∞–∫ –¥–Ω—è
            </button>
        </form>
    </div>
</section>

<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫ -->
<section class="info-section">
    <h2><i class="fas fa-book-open"></i> –û –º–µ—Ç–æ–¥–∏–∫–µ</h2>
    <div class="info-card">
        <p>–ù—É–º–µ—Ä–æ–ª–æ–≥–∏—è ‚Äî —ç—Ç–æ –¥—Ä–µ–≤–Ω–∏–π —è–∑—ã–∫ —á–∏—Å–µ–ª, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤–∏–±—Ä–∞—Ü–∏–∏ –í—Å–µ–ª–µ–Ω–Ω–æ–π. –ö–∞–∂–¥–∞—è –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –∫–∞–∂–¥–∞—è –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–∞—è –¥–∞—Ç–∞ –Ω–µ—Å—É—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–æ–±—ã—Ç–∏—è, –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.</p>
        <p>–ù–∞ —ç—Ç–æ–º –ø–æ—Ä—Ç–∞–ª–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –Ω—É–º–µ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞:</p>
        <ul>
            <li><strong>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ß–∏—Å–ª–∞ –ì–æ–¥–∞</strong> ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–Ω –∏ —Ç–µ–º–∞ –ø–µ—Ä–∏–æ–¥–∞</li>
            <li><strong>–≠–Ω–µ—Ä–≥–∏–∏ –ì–æ–¥–∞</strong> ‚Äî –≥–ª—É–±–∏–Ω–Ω–∞—è –≤–∏–±—Ä–∞—Ü–∏—è, –≤–ª–∏—è—é—â–∞—è –Ω–∞ –≤—Å–µ —Å—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏</li>
            <li><strong>–ß–∏—Å–ª–∞ –ú–µ—Å—è—Ü–∞</strong> ‚Äî —Ñ–æ–∫—É—Å –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥</li>
            <li><strong>–ß–∏—Å–ª–∞ –î–Ω—è</strong> ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π</li>
        </ul>
        <p class="disclaimer"><i class="fas fa-exclamation-circle"></i> –î–∞–Ω–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –Ω–æ—Å–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä. –ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –≤—ã ‚Äî —Ç–≤–æ—Ä–µ—Ü —Å–≤–æ–µ–π —Å—É–¥—å–±—ã.</p>
    </div>
</section>
{% endblock %}